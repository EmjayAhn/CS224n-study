<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!-->
<html lang="en">
<!--<![endif]-->

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <meta name="keywords" content="">

    <title>CS224n | Group Study</title>

    <link rel="shortcut icon" href="images/favicon.ico" type="image/x-icon">

    <link rel="stylesheet" type="text/css" href="fonts/font-awesome-4.3.0/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="css/stroke.css">
    <link rel="stylesheet" type="text/css" href="css/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="css/animate.css">
    <link rel="stylesheet" type="text/css" href="css/prettyPhoto.css">
    <link rel="stylesheet" type="text/css" href="css/style.css">

    <link rel="stylesheet" type="text/css" href="js/syntax-highlighter/styles/shCore.css" media="all">
    <link rel="stylesheet" type="text/css" href="js/syntax-highlighter/styles/shThemeRDark.css" media="all">

    <!-- CUSTOM -->
    <link rel="stylesheet" type="text/css" href="css/custom.css">

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- <style>
        /* webkit printing magic: print all background colors */
        html {
            -webkit-print-color-adjust: exact;
        }
        * {
            box-sizing: border-box;
            -webkit-print-color-adjust: exact;
        }
        
        html,
        body {
            margin: 0;
            padding: 0;
        }
        @media only screen {
            body {
                margin: 2em auto;
                max-width: 900px;
                color: rgb(55, 53, 47);
            }
        }
        
        body {
            line-height: 1.5;
            white-space: pre-wrap;
        }
        
        a,
        a.visited {
            color: inherit;
            text-decoration: underline;
        }
        
        .pdf-relative-link-path {
            font-size: 80%;
            color: #444;
        }
        
        h1,
        h2,
        h3 {
            letter-spacing: -0.01em;
            line-height: 1.2;
            font-weight: 600;
            margin-bottom: 0;
        }
        
        .page-title {
            font-size: 2.5rem;
            font-weight: 700;
            margin-top: 0;
            margin-bottom: 0.75em;
        }
        
        h1 {
            font-size: 1.875rem;
            margin-top: 1.875rem;
        }
        
        h2 {
            font-size: 1.5rem;
            margin-top: 1.5rem;
        }
        
        h3 {
            font-size: 1.25rem;
            margin-top: 1.25rem;
        }
        
        .source {
            border: 1px solid #ddd;
            border-radius: 3px;
            padding: 1.5em;
            word-break: break-all;
        }
        
        .callout {
            border-radius: 3px;
            padding: 1rem;
        }
        
        figure {
            margin: 1.25em 0;
            page-break-inside: avoid;
        }
        
        figcaption {
            opacity: 0.5;
            font-size: 85%;
            margin-top: 0.5em;
        }
        
        mark {
            background-color: transparent;
        }
        
        .indented {
            padding-left: 1.5em;
        }
        
        hr {
            background: transparent;
            display: block;
            width: 100%;
            height: 1px;
            visibility: visible;
            border: none;
            border-bottom: 1px solid rgba(55, 53, 47, 0.09);
        }
        
        img {
            max-width: 100%;
        }
        
        @media only print {
            img {
                max-height: 100vh;
                object-fit: contain;
            }
        }
        
        @page {
            margin: 1in;
        }
        
        .collection-content {
            font-size: 0.875rem;
        }
        
        .column-list {
            display: flex;
            justify-content: space-between;
        }
        
        .column {
            padding: 0 1em;
        }
        
        .column:first-child {
            padding-left: 0;
        }
        
        .column:last-child {
            padding-right: 0;
        }
        
        .table_of_contents-item {
            display: block;
            font-size: 0.875rem;
            line-height: 1.3;
            padding: 0.125rem;
        }
        
        .table_of_contents-indent-1 {
            margin-left: 1.5rem;
        }
        
        .table_of_contents-indent-2 {
            margin-left: 3rem;
        }
        
        .table_of_contents-indent-3 {
            margin-left: 4.5rem;
        }
        
        .table_of_contents-link {
            text-decoration: none;
            opacity: 0.7;
            border-bottom: 1px solid rgba(55, 53, 47, 0.18);
        }
        
        table,
        th,
        td {
            border: 1px solid rgba(55, 53, 47, 0.09);
            border-collapse: collapse;
        }
        
        table {
            border-left: none;
            border-right: none;
        }
        
        th,
        td {
            font-weight: normal;
            padding: 0.25em 0.5em;
            line-height: 1.5;
            min-height: 1.5em;
            text-align: left;
        }
        
        th {
            color: rgba(55, 53, 47, 0.6);
        }
        
        ol,
        ul {
            margin: 0;
            margin-block-start: 0.6em;
            margin-block-end: 0.6em;
        }
        
        li > ol:first-child,
        li > ul:first-child {
            margin-block-start: 0.6em;
        }
        
        ul > li {
            list-style: disc;
        }
        
        ul.to-do-list {
            text-indent: -1.7em;
        }
        
        ul.to-do-list > li {
            list-style: none;
        }
        
        .to-do-children-checked {
            text-decoration: line-through;
            opacity: 0.375;
        }
        
        ul.toggle > li {
            list-style: none;
        }
        
        ul {
            padding-inline-start: 1.7em;
        }
        
        ul > li {
            padding-left: 0.1em;
        }
        
        ol {
            padding-inline-start: 1.6em;
        }
        
        ol > li {
            padding-left: 0.2em;
        }
        
        .mono ol {
            padding-inline-start: 2em;
        }
        
        .mono ol > li {
            text-indent: -0.4em;
        }
        
        .toggle {
            padding-inline-start: 0em;
            list-style-type: none;
        }
        
        /* Indent toggle children */
        .toggle > li > details {
            padding-left: 1.7em;
        }
        
        .toggle > li > details > summary {
            margin-left: -1.1em;
        }
        
        .selected-value {
            display: inline-block;
            padding: 0 0.5em;
            background: rgba(206, 205, 202, 0.5);
            border-radius: 3px;
            margin-right: 0.5em;
            margin-top: 0.3em;
            margin-bottom: 0.3em;
            white-space: nowrap;
        }
        
        .collection-title {
            display: inline-block;
            margin-right: 1em;
        }
        
        time {
            opacity: 0.5;
        }
        
        .icon {
            display: inline-block;
            max-width: 1.2em;
            max-height: 1.2em;
            text-decoration: none;
            vertical-align: text-bottom;
            margin-right: 0.5em;
        }
        
        img.icon {
            border-radius: 3px;
        }
        
        .user-icon {
            width: 1.5em;
            height: 1.5em;
            border-radius: 100%;
            margin-right: 0.5rem;
        }
        
        .user-icon-inner {
            font-size: 0.8em;
        }
        
        .text-icon {
            border: 1px solid #000;
            text-align: center;
        }
        
        .page-cover-image {
            display: block;
            object-fit: cover;
            width: 100%;
            height: 30vh;
        }
        
        .page-header-icon {
            font-size: 3rem;
            margin-bottom: 1rem;
        }
        
        .page-header-icon-with-cover {
            margin-top: -0.72em;
            margin-left: 0.07em;
        }
        
        .page-header-icon img {
            border-radius: 3px;
        }
        
        .link-to-page {
            margin: 1em 0;
            padding: 0;
            border: none;
            font-weight: 500;
        }
        
        p > .user {
            opacity: 0.5;
        }
        
        td > .user,
        td > time {
            white-space: nowrap;
        }
        
        input[type="checkbox"] {
            transform: scale(1.5);
            margin-right: 0.6em;
            vertical-align: middle;
        }
        
        p {
            margin-top: 0.5em;
            margin-bottom: 0.5em;
        }
        
        .image {
            border: none;
            margin: 1.5em 0;
            padding: 0;
            border-radius: 0;
            text-align: center;
        }
        
        .code,
        code {
            background: rgba(135, 131, 120, 0.15);
            border-radius: 3px;
            padding: 0.2em 0.4em;
            border-radius: 3px;
            font-size: 85%;
            tab-size: 2;
        }
        
        code {
            color: #eb5757;
        }
        
        .code {
            padding: 1.5em 1em;
        }
        
        .code > code {
            background: none;
            padding: 0;
            font-size: 100%;
            color: inherit;
        }
        
        blockquote {
            font-size: 1.25em;
            margin: 1em 0;
            padding-left: 1em;
            border-left: 3px solid rgb(55, 53, 47);
        }
        
        .bookmark-href {
            font-size: 0.75em;
            opacity: 0.5;
        }
        
        .sans { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
        .code { font-family: 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace; }
        .serif { font-family: Lyon-Text, Georgia, KaiTi, STKaiTi, '华文楷体', KaiTi_GB2312, '楷体_GB2312', serif; }
        .mono { font-family: Nitti, 'Microsoft YaHei', '微软雅黑', monospace; }
        .pdf .sans { font-family: Inter, -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC', 'Noto Sans CJK KR'; }
        
        .pdf .code { font-family: Source Code Pro, 'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC', 'Noto Sans Mono CJK KR'; }
        
        .pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, KaiTi, STKaiTi, '华文楷体', KaiTi_GB2312, '楷体_GB2312', serif, 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC', 'Noto Sans CJK KR'; }
        
        .pdf .mono { font-family: PT Mono, Nitti, 'Microsoft YaHei', '微软雅黑', monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC', 'Noto Sans Mono CJK KR'; }
        
        .highlight-default {
        }
        .highlight-gray {
            color: rgb(155,154,151);
        }
        .highlight-brown {
            color: rgb(100,71,58);
        }
        .highlight-orange {
            color: rgb(217,115,13);
        }
        .highlight-yellow {
            color: rgb(223,171,1);
        }
        .highlight-teal {
            color: rgb(15,123,108);
        }
        .highlight-blue {
            color: rgb(11,110,153);
        }
        .highlight-purple {
            color: rgb(105,64,165);
        }
        .highlight-pink {
            color: rgb(173,26,114);
        }
        .highlight-red {
            color: rgb(224,62,62);
        }
        .highlight-gray_background {
            background: rgb(235,236,237);
        }
        .highlight-brown_background {
            background: rgb(233,229,227);
        }
        .highlight-orange_background {
            background: rgb(250,235,221);
        }
        .highlight-yellow_background {
            background: rgb(251,243,219);
        }
        .highlight-teal_background {
            background: rgb(221,237,234);
        }
        .highlight-blue_background {
            background: rgb(221,235,241);
        }
        .highlight-purple_background {
            background: rgb(234,228,242);
        }
        .highlight-pink_background {
            background: rgb(244,223,235);
        }
        .highlight-red_background {
            background: rgb(251,228,228);
        }
        .block-color-default {
            color: inherit;
            fill: inherit;
        }
        .block-color-gray {
            color: rgba(55, 53, 47, 0.6);
            fill: rgba(55, 53, 47, 0.6);
        }
        .block-color-brown {
            color: rgb(100,71,58);
            fill: rgb(100,71,58);
        }
        .block-color-orange {
            color: rgb(217,115,13);
            fill: rgb(217,115,13);
        }
        .block-color-yellow {
            color: rgb(223,171,1);
            fill: rgb(223,171,1);
        }
        .block-color-teal {
            color: rgb(15,123,108);
            fill: rgb(15,123,108);
        }
        .block-color-blue {
            color: rgb(11,110,153);
            fill: rgb(11,110,153);
        }
        .block-color-purple {
            color: rgb(105,64,165);
            fill: rgb(105,64,165);
        }
        .block-color-pink {
            color: rgb(173,26,114);
            fill: rgb(173,26,114);
        }
        .block-color-red {
            color: rgb(224,62,62);
            fill: rgb(224,62,62);
        }
        .block-color-gray_background {
            background: rgb(235,236,237);
        }
        .block-color-brown_background {
            background: rgb(233,229,227);
        }
        .block-color-orange_background {
            background: rgb(250,235,221);
        }
        .block-color-yellow_background {
            background: rgb(251,243,219);
        }
        .block-color-teal_background {
            background: rgb(221,237,234);
        }
        .block-color-blue_background {
            background: rgb(221,235,241);
        }
        .block-color-purple_background {
            background: rgb(234,228,242);
        }
        .block-color-pink_background {
            background: rgb(244,223,235);
        }
        .block-color-red_background {
            background: rgb(251,228,228);
        }
        
        .checkbox {
            display: inline-flex;
            vertical-align: text-bottom;
            width: 16;
            height: 16;
            background-size: 16px;
            margin-left: 2px;
            margin-right: 5px;
        }
        
        .checkbox-on {
            background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
        }
        
        .checkbox-off {
            background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
        }
            
        </style> -->
</head>

<body>

    <div id="wrapper">

        <div class="container">

            <section id="top" class="section docs-heading">

                <div class="row">
                    <div class="col-md-12">
                        <div class="big-title text-center">
                            <h1>CS224n: Results of Group Study</h1>
                            <p class="lead">written by 
                                <a href="https://github.com/emjayahn">EmjayAhn</a>,
                                <a href="https://github.com/jaeseongyou">JaeseongYou</a>,
                                <a href="https://github.com/donariumdebbie">donariumdebbie</a>
                            </p>
                        </div>
                        <!-- end title -->
                    </div>
                    <!-- end 12 -->
                </div>
                <!-- end row -->

                <hr>

            </section>
            <!-- end section -->

            <div class="row">

                <div class="col-md-3">
                    <nav class="docs-sidebar" data-spy="affix" data-offset-top="300" data-offset-bottom="200" role="navigation">
                        <ul class="nav">
                            <li><a href="#line1">Lecture 01</a></li>
                            <li><a href="#line2">Lecture 02</a></li>
                            <!-- <li><a href="#line3">How to Install Theme</a></li>
                            <li><a href="#line4">Necessary Plugins</a></li>
                            <li><a href="#line5">Creating Blog Pages</a></li>
                            <li><a href="#line6">Revolution Slider</a></li>
                            <li><a href="#line7">How to Use Option Panel</a>
                                <ul class="nav">
                                    <li><a href="#line7_1">General Options</a></li>
                                    <li><a href="#line7_2">Style Options</a></li>
                                    <li><a href="#line7_3">Header Options</a></li>
                                    <li><a href="#line7_4">Font Options</a></li>
                                    <li><a href="#line7_5">Slider Options</a></li>
                                    <li><a href="#line7_6">Page Options</a></li>
                                    <li><a href="#line7_7">Import & Export</a></li>
                                </ul>
                            </li>
                            <li><a href="#line8">Support Desk</a></li>
                            <li><a href="#line9">Files & Sources</a></li>
                            <li><a href="#line10">Version History (Changelog)</a></li>
                            <li><a href="#line11">Copyright and license</a></li> -->
                        </ul>
                    </nav >
                </div>
                <div class="col-md-9">
                    <section class="welcome">

                        <div class="row">
                            <div class="col-md-12 left-align">
                                <h2 class="dark-text">Introduction<hr></h2>
                                <div class="row">

                                    <div class="col-md-12 full">
                                        <div class="intro1">
                                            <ul>
                                                <li><strong>Lecture Name : </strong>CS224n</li>
                                                <li><strong>Lecture Version : </strong> Winter 2019</li>
                                                <li><strong>Lecture Link  : </strong> <a href="https://www.youtube.com/watch?v=8rXD5-xhemo&t=1s">Standford Univiersity CS224n</a></li>
                                                <li><strong>Page Authors : </strong> <a href="https://github.com/emjayahn">Emjayahn</a>, <a href="https://github.com/jaeseongyou">JaeseongYou</a>,
                                                    <a href="https://github.com/donariumdebbie">donariumdebbie</a></li>
                                            </ul>
                                        </div>

                                        <hr>
                                        <div>
                                            <p> CS224n을 함께 들으면서 공부해봅시다.
                                            </p>
                                            <div class="intro2 clearfix">
                                                <p><i class="fa fa-exclamation-triangle"></i> 저희가 개인적으로 공부한 내용입니다. 아래 내용중 잘못 이해한 내용이 있을 수 있습니다. 
                                                </p>
                                            </div>

                                        </div>
                                    </div>

                                </div>
                                <!-- end row -->
                            </div>
                        </div>
                    </section>

                    <section id="line1" class="section">

                        <div class="row">
                            <div class="col-md-12 left-align">
                                <h2 class="dark-text">Lecture 01<a href="#top">#back to top</a><hr></h2>
                            </div>
                            <!-- end col -->
                        </div>
                        <!-- end row -->

                        <div class="row">
                            <div class="col-md-12">
                                <article id="e7574b2d-8a4d-41f3-8700-8f7077247b8f" class="page sans"><header><h1 class="page-title">written by <a href="https://github.com/emjayahn">EmjayAhn</a></h1></header><div class="page-body"><h1 id="0a6297f1-d0e0-41af-8090-a609232e1fb7" class="">[CS224n] Lecture 1: Introduction and Word Vectors</h1><p id="9756b33e-85e1-4a84-8d14-3626b41f4a92" class="">Standford University 의 CS224n 강의를 듣고 정리하는 글입니다.</p><h2 id="ef927be2-3662-49bd-8850-1c69e86ea48f" class="">1. Human Language and Word Meaning</h2><p id="625ded1b-b2bd-4324-94c4-9bdab090fd87" class=""><strong>Word meaning</strong> 의 뜻 : symbol → idea or thing : Denotational Semantics</p><p id="f34f7656-4bb2-406c-9da7-ea91ae0a1bea" class="">우리가 ’의자’라는 단어를 예로 들자면, 말하는 사람과 듣는 사람 모두 의자와 관련된 특정한 이미지와 아이디어 등을 생각해 볼 수 있다. 이렇게 단어에 대해 관념적인 것을 word meaning 이라고 할 수 있다. 그렇다면 컴퓨터에서 사용할 수 있는 <strong>word meaning</strong> 은 어떤 것이 있을까?</p><h3 id="58aef56d-f8e4-463a-b865-1165af348af0" class="">In Computer Word Representations</h3><ol id="1d0b8fcc-cc91-4bce-abf1-6c31f6fff526" class="numbered-list" start="1"><li>WordNet: synonym 과 hypernyms 의 집합으로 표현 (e.g: nltk wordnet)<ul id="774ad5b8-9256-40b9-a200-7581c8992c3d" class="bulleted-list"><li>아주 귀한 dataset 이지만,</li></ul><ul id="6566d47a-4df6-4550-99aa-8f8cb52aff8d" class="bulleted-list"><li>단점: Nuance (뉘앙스)를 담아내지 못함, 새로운 단어에 대해 사람이 직접 가공하여 추가해주어야 한다. 단어의 동의어에 대해 계산할 수 없음</li></ul></li></ol><ol id="2fe002f4-f51e-4faa-b062-28d3c97e15b3" class="numbered-list" start="2"><li>Discrete Symbols: One-hot-vectors<ul id="c39a9a2b-ff10-4fd3-b9f1-68713325192a" class="bulleted-list"><li>단점 : 벡터의 차원이 우리가 가지고 있는 단어의 갯수만큼 커지게 된다. Corpus 의 구성 단어가 커질 수록 계산 해야하는 벡터 차원이 매우 커진다. 이는 컴퓨팅 자원의 부족으로 인한 현실적 구현의 어려움을 야기시킨다.</li></ul><ul id="3b220304-f27c-4441-80df-42060ddb2487" class="bulleted-list"><li>One-hot-Vector 는 Vector Space 에서 모두 서로 orthogonal (직교)한다. 즉, similarity 가 모두 0으로 단어간의 관계를 알기 힘들다.</li></ul></li></ol><ol id="c9bed0e7-3e87-4dc3-916f-30f3b51f771f" class="numbered-list" start="3"><li>By CONTEXT: Word Vecttors<ul id="8efefc45-1db9-44af-871b-684a33c13b09" class="bulleted-list"><li>“You shall know a word by the company it keeps” (J.R.Firth)</li></ul><ul id="6376f52f-178c-4ea0-ae16-ba504a79b005" class="bulleted-list"><li>어떤 특정 단어 w 가 나온다는 것은, 그 주변 단어들(context)이 있기 때문이다.</li></ul><ul id="cd6166c5-bc0d-4398-8607-9c1b5153fe36" class="bulleted-list"><li>Word Vectors == Word Embeddings == Word Representations == Distributed Representation</li></ul></li></ol><h2 id="9a7079b1-9991-41af-a71d-72d43bdd4587" class="">2. Word2vec Introduction</h2><p id="680775a9-d92d-4d2b-b637-703701faaf66" class="">Word2vec(Mikolov et al. 2013) 은 Word Vectors 를 만들기 위한 알고리즘 중 가장 기초 뼈대를 이루는 알고리즘이다.</p><ol id="104f534e-5c30-4f64-9e84-d6861517d08f" class="numbered-list" start="1"><li>가지고 있는 텍스트 데이터를 구성하는 큰 CORPUS</li></ol><ol id="ad31382f-2b32-4ec2-9a6e-b94ed5fca6cd" class="numbered-list" start="2"><li>Corpus 의 모든 단어는 RandomVector 로 시작한다.</li></ol><ol id="d992ae61-595f-447d-8d8d-119c25f64207" class="numbered-list" start="3"><li>각 position t 에 대해, 중심단어 c(center) 와 주변단어 o(outside) 를 생각할 수 있다.</li></ol><ol id="384c5626-d5d1-4008-baf7-0a970d203224" class="numbered-list" start="4"><li>중심단어 c 가 주어질 때, 주변단어 o 의 확률을 구하기 위해(skip-gram)(반대로도 가능(cbow): 주변단어가 주어질 때, 중심단어의 확률을 구하는 방법), 중심단어 c 와 주변단어 o, word 벡터들에 대해 similarity를 구한다.</li></ol><ol id="9c1f6417-8fc6-4edf-9fde-f3f63c374134" class="numbered-list" start="5"><li>위의 확률을 최대화 하기 위해 word vector 를 updating 한다.</li></ol><figure id="93ba71ce-053a-439a-8a5f-4d8a8381778a" class="image"><a href="Untitled-cc28ca48-12e4-4a20-a6c4-b0be86d339d8.png"><img src="Untitled-cc28ca48-12e4-4a20-a6c4-b0be86d339d8.png"/></a></figure><h2 id="8439b54e-8217-4402-8a1f-3a629541f71e" class="">3. Word2vec objective function gradients</h2><p id="61f2634d-7b5b-4201-ac45-560cb0b2307b" class="">문장의 특정 위치 t 에 대해 (t = 1, …, T), 중심단어w_j가 주어졌을때, 주변단어를 한정하는 window size m 에 대해 주변단어들을 예측하는 Likelihood 는 다음과 같습니다. likelihood 식을 해석해보면, 중심단어 w_t 에 대해 중심단어를 중심으로 window 사이즈 2m 개의 단어들의 확률을 모두 곱하고, T 개의 단어 갯수에 대해 또 다시 모두 곱합니다.</p><p id="79f602ca-e366-4c7f-89cb-9ae1a464fd43" class="">$$Likelihood\quad L(\theta)= \prod_{t=1}^{T}\prod_{-m \leq j \leq m}P(w_{t+j}|w_{t};\theta)$$</p><p id="1ee0ca14-f029-44a0-aed0-5b1c7a4d1597" class="">목적함수는 likelihood 를 바탕으로 minimize와 average, 계산 편의를 위해 log 를 씌웠다는 것외에 likelihood 와 동일하다.</p><p id="82d29776-5a94-41ad-b448-895fe7c3086e" class="">$$objective function \quad J(\theta) = - \frac{1}{T}logL(\theta)=-\frac{1}{T}\sum_{t=1}^{T}\sum_{-m \leq j \leq m, j\neq0}logP(w_{t+j} | w_{t};\theta)$$</p><p id="33bf6501-f26c-4abb-b95e-706bbdbad380" class="">단어가 등장할 확률을 구하는 방법은 Softmax Function 을 활용합니다.</p><figure id="b2d18958-9caf-415b-9688-1dfe5816445b" class="image"><a href="Untitled-99acc04b-91fd-451c-868f-574d995778b3.png"><img src="Untitled-99acc04b-91fd-451c-868f-574d995778b3.png"/></a></figure><h3 id="0b033c98-99ac-4ddb-b0ac-978553511b22" class="">Objective Function 의 derivative</h3><p id="7ec91303-b052-408d-a030-e17499dc28fc" class="">Objective Function 과 단어 확률 (Softmax) 의 미분을 구하는 과정이다.</p><figure id="3a7b9038-90fe-4a30-96f3-6b73636f4157" class="image"><a href="Untitled-d45516b7-8024-457c-bda2-39092a1f6892.png"><img src="Untitled-d45516b7-8024-457c-bda2-39092a1f6892.png"/></a></figure></div></article>
                            </div>
                            <!-- end col -->
                        </div>
                        <!-- end row -->
                    </section>
                    <!-- end section -->

                    <section id="line2" class="section">

                            <div class="row">
                                <div class="col-md-12 left-align">
                                    <h2 class="dark-text">Lecture 02<a href="#top">#back to top</a><hr></h2>
                                </div>
                                <!-- end col -->
                            </div>
                            <!-- end row -->
    
                            <div class="row">
                                <div class="col-md-12">
                                    <article id="2369deaa-eeb6-4af0-9b57-b84532214592" class="page sans"><header><h1 class="page-title">written by <a href="https://github.com/jaeseongyou">JaeseongYou</a></h1></header><div class="page-body"><h3 id="c6f8d81f-a7a9-45b2-a363-7683d19c6c23" class="">Main Idea of Word2Vec</h3><p id="6ee847b2-e888-4b25-8cff-fb22db6bd1fc" class="">각 단어는 주변에 출현하는 단어들로 정의됩니다.</p><p id="a05e63f8-e10f-4a39-820f-fb5a5cf70909" class="">학습과정에서 벡터는 p(주변단어|중심단어)가 높도록 변화됩니다.</p><p id="9d8a2421-60cc-42b0-b3e4-b754f195ab95" class="">비슷한 단어들을 주변에 갖는 단어들은 임베딩 공간에서 서로 가까이 위치하게 됩니다.</p><h3 id="cebaf8ec-0cd3-4e86-85a9-42991ac7c41a" class="">두 행렬: U와 V</h3><p id="92dfc8e9-9984-47aa-8485-5912049a78e0" class="">[이전 질문] dL/du와 dL/dv를 따로 구해서 u와 v를 각각 업데이트하면 사실상 네트워크 둘을 트레이닝 하는 것으로 보이는데, 왜 u와 v로 나누는 것이 더 간단한가요?</p><p id="d7c704c7-61c6-4389-824a-8a7ca83bded5" class="">[대답] 만약 한 행렬만 쓸 경우, 중심단어가 주변단어 후보로 한 번 등장하게 되는데, 2승 텀이 되고 미분 계산이 더 어려워집니다.</p><p id="a07aaa79-fec0-4dfc-91d4-e8cb2ec0a9ee" class="">모든 단어가 ’the’나 ’a’와 같이 빈번한 단어에 대한 높은 점곱을 가지게 됩니다. 해결법 1: PCA 후 첫번째 component를 제거 (빈도를 나타내므로) 해결법 2: Negative Sampling</p><h3 id="9afb3e7d-5fe2-4642-8cda-7b62496ba13f" class="">최적화</h3><p id="a6e3290f-cded-4dc7-afe5-7659618e92d3" class=""><em>θ</em><em>n</em><em>e</em><em>w</em> = <em>θ</em><em>o</em><em>l</em><em>d</em> − <em>α</em>∇<em>θ</em><em>J</em>(<em>θ</em>)</p><p id="ff67bae8-fb1f-4ade-bb6c-d15246301b54" class="">보통 SGD로 최적화</p><pre id="7a1c89bb-61f2-4bbb-8ae2-7cf07a414194" class="code"><code>while True:window = sample_window(corpus)theta_grad = evaluate_gradient(J, window, theta)theta = theta - alpha * theta_grad</code></pre><h3 id="e70acb69-c762-43eb-8b85-8fd2597e2407" class="">Sparsity 문제</h3><p id="8352696d-8fc0-4e8b-8b74-0163baf0c89f" class="">윈도우 크기가 5일 때, 최대 11개의 단어가 등장, 배치 사이즈가 32이면 최대 출현 단어는 352개가 됩니다. dimension_size * batch_size * num_words = 300 * 32 * 11 = 105,600개 값</p><p id="2742626f-6053-4a48-9e52-a4513cb44c7d" class="">반면 업데이트 해야하는 파라미터는 U와 V 각각 dimension_size * vocabulary_size로 2* 300 * 2,000,000, 약 12억개.</p><h3 id="4cc4ef08-354f-4811-9976-f6cca6694086" class="">해결법1</h3><p id="9f80a12f-1146-4c1b-8668-6b734bdd1c4a" class="">U와 V에서 해당하는 단어의 행만 업데이트 합니다.</p><ul id="6c9a88fb-89cd-4707-a02d-1b902ff80a7a" class="bulleted-list"><li>질문 01: 어떻게 특정 행만 골라서 업데이트 할 수 있나요?</li></ul><ul id="e078d63f-8d78-4aca-b9a2-b4160ee4c5c6" class="bulleted-list"><li>Debbie : 등장한 row의 gradient를 계산해서 matrix add, subtraction 으로 gradient update한다는 말인 것 같습니다.</li></ul><ul id="0c3959c9-9c85-48e9-a0b0-f455e2dfae89" class="bulleted-list"><li>질문 02: 윈도우 크기가 5일 때 매 배치에 대해서 V는 1 행 U는 5 행 비대칭적으로 학습되지 않을까요?</li></ul><h3 id="8fb6c77b-9fae-4b63-947e-e0c7a931b7cf" class="">해결법2</h3><p id="a6870eae-30b8-448f-a52b-1137620856ce" class="">단어 벡터에 대해서 해쉬를 보존합니다.</p><ul id="567d2d5c-72fd-4953-81e4-7468e5174ee6" class="bulleted-list"><li>질문 03: 이게 무슨 뜻일까요??</li></ul><ul id="9a601ef5-93b5-4f10-a2b7-7ae0a8670ea8" class="bulleted-list"><li>Debbie : hash embedding이라는 게 있는데, feature를 제한된 숫자로 변환해주는 함수를 사용하는 방법이라고 합니다. python dict가 사용하는 hash와는 다른 개념이고, hash embedding이 여러 종류가 있고 Bloom Embedding등이 NLP에서 사용된다고 합니다.</li></ul><h3 id="c67a3e59-51c3-44f3-ac2c-322f24f2d95d" class="">Negative Sampling (SG)</h3><p id="de442c67-4d45-4e6a-bbb0-694d7079d4bf" class="">문제를 다르게 Softmax: 2백만 단어 → Binary 로지스틱 회귀: 참 쌍 (주변단어-중심단어) vs. 거짓 쌍(무작위단어-중심단어)</p><ul id="8fe4390c-2042-429e-99f4-d2f1564df4c6" class="bulleted-list"><li>질문 04: $J(\theta) = \frac{1}{T}\sum_{t=1}^TJ_t(\theta)$ 라면 t는 무엇을 의미하나요? (p13)</li></ul><p id="3a6b9f2d-4cd5-4b3c-ac63-fcd31d81302e" class="">$J_{neg-sample}(o, v_c, U) = -log((u_o^Tv_c)) - _{i=1}k(log((u_kTv_c)) $</p><p id="33dfa6af-5b8f-457f-8c3b-08057f2a81a9" class=""><em>P</em>(<em>w</em>) = <em>c</em><em>o</em><em>u</em><em>n</em><em>t</em>(<em>w</em>)3/4/<em>Z</em> 의 확률에 따라 k개 (보통 15)의 단어를 주변단어 외 단어에서 골라 거짓 쌍을 만듭니다. 빈번한 단어가 더 많이 뽑히되 3/4승 때문에 그 빈도가 상대적으로 플랫하게 됩니다.</p><h3 id="4b1e495d-ec38-459b-8644-598db24a368a" class="">동시발생 행렬</h3><p id="696f0076-adfc-4a97-a2eb-fb3b5aad850e" class=""><em>X</em><em>i</em><em>j</em>: <em>w</em><em>o</em><em>r</em><em>d</em><em>i</em>와 <em>w</em><em>o</em><em>r</em><em>d</em><em>j</em>가 윈도우 내 동시발생한 경우를 카운트합니다.</p><h3 id="fd921882-dd83-46d5-9805-49f5eeb39a88" class="">SVD</h3><p id="708ff959-9bba-4181-a1f9-9f4e7b5ba5f3" class=""><em>X</em> = <em>U</em><em>Σ</em><em>V</em><em>T</em> (X가 symmetric이므로 EigenDecomposition과 동일) <em>S</em><em>i</em><em>g</em><em>m</em><em>a</em>의 특이값의 수를 조정해 차원 축소를 할 수 있습니다.</p><h3 id="4e7de017-db45-43bc-b342-3d352bd87ce4" class="">Rohde 트릭</h3><p id="8aeeb89b-bac6-4071-9cd1-fa386228eeb0" class="">​ 카운트 스케일링(빈번한 단어 capping)을 합니다. ​ 윈도우 조정 (유사한 단어를 더 많이 카운트 합니다.) ​ 카운트 대신 피어슨 코릴레이션을 사용합니다.</p><ul id="6a770e94-e142-43b9-9bbd-ebdcc0bce9da" class="bulleted-list"><li>질문 05: 윈도우 조정은 Word2Vec에도 사용되었다고 하는데 Negative Sampling의 P(w)를 말한 것일까요?</li></ul><h3 id="5e72c4d1-d1f5-4f89-a4b9-21d6e00d4f5a" class="">Glove</h3><p id="de118be0-48ba-4b44-b6ed-8e962fed3f0e" class="">동시발생 확률의 비율(=벡터간 차이)로 의미를 인코딩할 수 있습니다.</p><p id="6065d404-cec2-43ab-a549-460539602ed0" class="">방향을 암시하는 단어들의 비율은 커지고, 나머지 관련이 없거나 의미가 일정한 단어의 비율은 1에 가까워집니다.</p><p id="4b49e026-6ab1-4463-b738-4dc477e41254" class="">동시발생 확률의 비율이 임베딩 공간에서 선형적이 되도록 하는 것이 목표입니다.</p><h3 id="903e9c04-7774-470b-9dea-6b4fb5bc2dd1" class="">계산</h3><p id="7d79503a-94cd-42ba-a7d5-4828bf79061e" class="">점곱이 동시발생 확률의 로그가 되도록 하고, 로그 동시발생 확률의 비율을 구하면 자연스럽게 벡터간 차가 나옵니다.</p><p id="5e94a37b-a9fb-49ee-bfcc-81ff924e8b06" class=""><em>w</em><em>i</em> ⋅ <em>w</em><em>j</em> = <em>l</em><em>o</em><em>g</em><em>P</em>(<em>i</em>|<em>j</em>)</p><p id="c4aff26b-3541-42f8-b90e-abc8f0f10d9b" class="">$w_x \cdot (w_a - w_b) = \frac{logP(x|a)}{logP(x|b)}$ (예: a는 ‘얼음’, b가 ’증기’이면 주요 x는 고체와 기체)</p><p id="6a016674-146e-4c2b-8317-7f2afbca416e" class="">$J = \sum_{i,j=1}^Vf(X_{ij})(w_i^Tw_j + b_i + b_j -logX_{ij})^2$ (<em>w</em><em>i</em><em>T</em><em>w</em><em>j</em> − <em>l</em><em>o</em><em>g</em><em>X</em><em>i</em><em>j</em>)2단어 i와 j 사이의 점곱이 동시발생 확률의 로그와 비슷해야 합니다. <em>f</em>(<em>X</em><em>i</em><em>j</em>)는 <em>P</em>(<em>w</em>)3/4와 비슷한 역할을 수행하여 빈번한 단어쌍이 모델에 지나치게 큰 영향을 끼치지 못하도록 합니다.</p><h3 id="c7ab6b7d-6844-40e2-8d08-87cd177053bb" class="">다의어</h3><h3 id="b2ab020f-ef3e-4e85-8b95-328d2521fa39" class="">해결법 1</h3><p id="aeb7091d-dc1c-4597-b533-2d1562205c36" class="">클러스터링을 통해 bank를 bank1, bank2, …, bank5로 나눕니다. 의미간 구분이 불분명한 경우가 있습니다.</p><h3 id="01be2fca-1705-4c6c-84ba-d2e75220ac29" class="">해결법 2</h3><p id="d9aea087-f9e6-429f-bda7-6056c29c05f6" class="">$v_{bank} = <em>1v</em>{bank_1} + <em>2v</em>{bank_2} + etc. $ : weighted average (superposition) of sub-meanings <em>α</em>1 = <em>f</em>1/(<em>f</em>1 + <em>f</em>2 + ...)</p><h3 id="b90ed8ac-ef95-47d5-ac6c-dbf2fa6eabf6" class="">Sparsity 결과</h3><p id="a0fe91e1-ad4d-45ae-ae9b-64b522d7036a" class="">스파스 코딩을 통해 의미를 분해할 수 있습니다.</p><h3 id="ccf08c91-758c-4cef-ac39-4d2b8e1ad01a" class="">평가방식</h3><p id="dd94b806-d547-466c-9b16-8a8d1b0df785" class="">코사인 유사도</p><p id="84ad7816-43af-4a41-8302-2416abb27aa7" class="">아날로지 빈칸</p><p id="453c1f4f-3075-4ea6-8e89-e2534c67d5cb" class="">Word Vector Analogies syntactic: superlatives etc. semantic: city-state etc.</p><p id="0d27aa90-07e4-468f-af87-2d6b3a5f4785" class="">WordSim353</p><h3 id="dfb684ac-eb58-4ae9-85e5-6c1878705245" class="">하이퍼 파라미터</h3><p id="1dcfcfd4-cc43-4363-96ad-6fcc7b06c96a" class="">차원수: 300</p><p id="ea0fbe6a-450e-4ea9-bedb-e0b55d35c2d9" class="">윈도우 크기: 5~10</p><p id="ad406646-cec2-4e4b-a2bc-93d2cb1796ac" class="">학습시간: 24 hrs</p><p id="fc1b9215-4cc1-4c24-95d5-8407b9283617" class="">데이터: Wikipedia</p><h3 id="1badd773-e4d3-4676-bba5-ba63bcdb0cc2" class=""></h3><ul id="b89b6d7d-50ce-422e-8c64-a111d8c7ed7c" class="bulleted-list"><li>Debbie 질문 + (위의 질문 1,3에 답변은 https://eda-ai-lab.tistory.com/122?category=706160 참고하였습니다)</li></ul><ul id="60710a69-f4ac-4e95-9c5e-ec58d302311b" class="bulleted-list"><li>p14 수식 맨 오른쪽에 sigmoid안의 마이너스 이유 좀더 구체적으로?</li></ul></div></article>
                                </div>
                                <!-- end col -->
                            </div>
                            <!-- end row -->
                        </section>


                </div>
                <!-- // end .col -->

            </div>
            <!-- // end .row -->

        </div>
        <!-- // end container -->

    </div>
    <!-- end wrapper -->

    <script src="js/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/retina.js"></script>
    <script src="js/jquery.fitvids.js"></script>
    <script src="js/wow.js"></script>
    <script src="js/jquery.prettyPhoto.js"></script>

    <!-- CUSTOM PLUGINS -->
    <script src="js/custom.js"></script>
    <script src="js/main.js"></script>

    <script src="js/syntax-highlighter/scripts/shCore.js"></script>
    <script src="js/syntax-highlighter/scripts/shBrushXml.js"></script>
    <script src="js/syntax-highlighter/scripts/shBrushCss.js"></script>
    <script src="js/syntax-highlighter/scripts/shBrushJScript.js"></script>

</body>

</html>
